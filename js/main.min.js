var playlist=[],current_wave="",current_track="",audio_player=document.getElementById("audio_player"),src=document.getElementById("src");function getRandomInt(a){return Math.floor(Math.random()*Math.floor(a))}function playVideo(){var a=document.getElementById("video");a.play(),a.addEventListener("ended",function(){$(".main video").hide(),$(".main .content").show()})}function getplaylist(){var t=$(".player"),r=$(".wave.current").attr("data-wave"),l="";$.ajax({url:"get-playlist.php",type:"POST",data:{wave:r},dataType:"json",error:function(){alert("При выполнении запроса произошла ошибка")},success:function(a){playlist=a,src.src=playlist[0].path,t.attr("data-wave",r),current_wave=r,t.attr("data-track",0);for(var e=current_track=0;e<playlist.length;e++)l+=0===e?'<div class="track current">'+playlist[e].name+"</div>":'<div class="track">'+playlist[e].name+"</div>";$(".music_list .wrapper").html(l),$(".music_list").mCustomScrollbar("update"),audio_player.load(),play_wave()}})}function playToggler(){$(".play").toggleClass("active"),$(".wave.current").toggleClass("active")}function play_wave(){audio_player.paused&&audio_player.play(),$(".play").addClass("active"),$(".wave.current").addClass("active"),$(".music_list").mCustomScrollbar("scrollTo",$(".track.current"))}function pause_wave(){audio_player.paused||(audio_player.pause(),$(".play").removeClass("active"),$(".wave.current").removeClass("active"))}function play_next(){var a;a=$(".shuffle").hasClass("off")?current_track+2>playlist.length?0:current_track+1:getRandomInt(playlist.length),src.src=playlist[a].path,$(".player").attr("data-track",a),current_track=a,$(".track").removeClass("current"),$(".track:eq("+current_track+")").addClass("current"),audio_player.load(),play_wave()}function playPause(){audio_player.paused?audio_player.play():audio_player.pause(),playToggler()}function setVolume(a){audio_player.volume=a}audio_player.addEventListener("ended",function(){if($(".repeat").hasClass("off"))return $(".play").removeClass("active"),void $(".wave.current").removeClass("active");play_next()}),$(document).ready(function(){playVideo(),$(".music_list").mCustomScrollbar();var a=$(".prev"),t=$(".play"),e=$(".next"),r=$(".mute");$(".repeat");$(".play, .pause").click(function(){audio_player.paused?audio_player.play():audio_player.pause(),playToggler()}),r.click(function(){$(this).toggleClass("muted"),$(this).hasClass("muted")?audio_player.muted=!0:audio_player.muted=!1}),$(".repeat, .shuffle").click(function(){$(this).toggleClass("off")}),a.click(function(){var a;a=$(".shuffle").hasClass("off")?0===current_track?playlist.length-1:current_track-1:getRandomInt(playlist.length),src.src=playlist[a].path,$(".player").attr("data-track",a),current_track=a,$(".track").removeClass("current"),$(".track:eq("+current_track+")").addClass("current"),audio_player.load(),play_wave()}),e.click(function(){play_next()}),$(".nav_el").click(function(){$(".nav_el, .screen").removeClass("active"),$(this).addClass("active");var a=$(this).attr("data-nav"),e=$('*[data-screen="'+a+'"]');e.addClass("active"),e.hasClass("radio")&&!t.hasClass("active")&&getplaylist()}),$(".wave").click(function(){$(".wave").removeClass("current active"),$(this).addClass("current");$(this).attr("data-wave");getplaylist()})});