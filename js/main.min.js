let currentWave,
  currentTrack,
  prevTrack,
  nextTrack,
  playlist = [],
  wave = document.getElementsByClassName("wave"),
  nav_el = document.getElementsByClassName("nav_el"),
  screens = document.getElementsByClassName("screen");
const video = document.getElementById("video"),
  audioPlayer = document.getElementById("audioPlayer"),
  player = document.getElementById("player"),
  playListWrapper = document.getElementById("playList"),
  shuffle = document.getElementById("shuffle"),
  prev = document.getElementById("prev"),
  play = document.getElementById("play"),
  next = document.getElementById("next"),
  repeat = document.getElementById("repeat"),
  mute = document.getElementById("mute"),
  src = document.getElementById("src");
function initMap() {
  new google.maps.Map(document.getElementById("map"), {
    center: { lat: 50.4021702, lng: 30.3926088 },
    zoom: 10,
    styles: [
      {
        featureType: "all",
        elementType: "labels.text.fill",
        stylers: [{ saturation: 36 }, { color: "#000000" }, { lightness: 40 }],
      },
      {
        featureType: "all",
        elementType: "labels.text.stroke",
        stylers: [
          { visibility: "on" },
          { color: "#000000" },
          { lightness: 16 },
        ],
      },
      {
        featureType: "all",
        elementType: "labels.icon",
        stylers: [{ visibility: "off" }],
      },
      {
        featureType: "administrative",
        elementType: "geometry.fill",
        stylers: [{ color: "#002b08" }, { lightness: "1" }],
      },
      {
        featureType: "administrative",
        elementType: "geometry.stroke",
        stylers: [{ color: "#005919" }, { lightness: "0" }, { weight: 1.2 }],
      },
      {
        featureType: "administrative",
        elementType: "labels.text.fill",
        stylers: [{ color: "#00ff3c" }],
      },
      {
        featureType: "landscape",
        elementType: "geometry",
        stylers: [{ color: "#ff0000" }],
      },
      {
        featureType: "landscape",
        elementType: "labels.text.fill",
        stylers: [{ color: "#00ff1c" }],
      },
      {
        featureType: "landscape.man_made",
        elementType: "geometry",
        stylers: [{ color: "#005a02" }],
      },
      {
        featureType: "landscape.natural",
        elementType: "geometry",
        stylers: [{ color: "#0c5116" }],
      },
      {
        featureType: "poi",
        elementType: "geometry",
        stylers: [
          { color: "#007a12" },
          { lightness: "-26" },
          { saturation: "-27" },
        ],
      },
      {
        featureType: "poi",
        elementType: "labels.text.fill",
        stylers: [{ color: "#00ff12" }],
      },
      {
        featureType: "poi",
        elementType: "labels.text.stroke",
        stylers: [{ color: "#025201" }],
      },
      {
        featureType: "poi.park",
        elementType: "geometry",
        stylers: [
          { color: "#006317" },
          { lightness: "-8" },
          { saturation: "-20" },
        ],
      },
      {
        featureType: "road.highway",
        elementType: "geometry.fill",
        stylers: [{ color: "#008d15" }, { lightness: 17 }, { weight: "1.75" }],
      },
      {
        featureType: "road.highway",
        elementType: "geometry.stroke",
        stylers: [
          { color: "#000000" },
          { lightness: "-4" },
          { weight: "1.10" },
        ],
      },
      {
        featureType: "road.highway",
        elementType: "labels.text.fill",
        stylers: [{ weight: "7.53" }, { color: "#000000" }],
      },
      {
        featureType: "road.highway",
        elementType: "labels.text.stroke",
        stylers: [{ color: "#03a100" }, { weight: "3.02" }],
      },
      {
        featureType: "road.arterial",
        elementType: "geometry",
        stylers: [{ lightness: 18 }],
      },
      {
        featureType: "road.arterial",
        elementType: "geometry.fill",
        stylers: [{ color: "#00ff1c" }, { weight: "1.64" }],
      },
      {
        featureType: "road.arterial",
        elementType: "geometry.stroke",
        stylers: [
          { color: "#000000" },
          { weight: "2.70" },
          { saturation: "32" },
          { lightness: "-6" },
          { visibility: "on" },
        ],
      },
      {
        featureType: "road.arterial",
        elementType: "labels.text",
        stylers: [{ visibility: "on" }, { color: "#211010" }],
      },
      {
        featureType: "road.arterial",
        elementType: "labels.text.fill",
        stylers: [{ color: "#000000" }],
      },
      {
        featureType: "road.arterial",
        elementType: "labels.text.stroke",
        stylers: [{ color: "#007803" }],
      },
      {
        featureType: "road.local",
        elementType: "geometry",
        stylers: [
          { lightness: 16 },
          { visibility: "on" },
          { color: "#000000" },
          { weight: "0.65" },
        ],
      },
      {
        featureType: "road.local",
        elementType: "labels",
        stylers: [{ visibility: "off" }],
      },
      {
        featureType: "transit",
        elementType: "geometry",
        stylers: [{ color: "#003503" }, { lightness: "1" }],
      },
      {
        featureType: "water",
        elementType: "geometry",
        stylers: [{ color: "#001f00" }, { lightness: "2" }],
      },
      {
        featureType: "water",
        elementType: "labels.text",
        stylers: [{ color: "#008909" }],
      },
    ],
  });
}
function getRandomInt(e) {
  return Math.floor(Math.random() * Math.floor(e));
}
function playVideo() {
  video.play(),
    video.addEventListener("ended", function () {
      (video.style.display = "none"),
        (document.getElementById("content").style.display = "block");
    });
}
function setActiveTrack(e) {
  (src.src = playlist[e].path),
    player.setAttribute("data-track", e),
    (currentTrack = e);
  let t = document.getElementsByClassName("track");
  for (let e = 0; e < t.length; e++)
    t[e].classList.remove("current"),
      e === currentTrack && t[e].classList.add("current");
  audioPlayer.load(), playWave();
}
audioPlayer.addEventListener("ended", function () {
  if (
    ((currentWave = document.getElementsByClassName("wave current")),
    repeat.classList.contains("off"))
  )
    return (
      play.classList.remove("active"),
      void currentWave.classList.remove("active")
    );
  playNext();
}),
  prev.addEventListener("click", function () {
    setActiveTrack(
      (prevTrack = shuffle.classList.contains("off")
        ? 0 === currentTrack
          ? playlist.length - 1
          : currentTrack - 1
        : getRandomInt(playlist.length))
    );
  }),
  play.addEventListener("click", function () {
    audioPlayer.paused ? audioPlayer.play() : audioPlayer.pause(),
      playToggler();
  }),
  next.addEventListener("click", function () {
    playNext();
  }),
  mute.addEventListener("click", function () {
    mute.classList.toggle("muted"),
      (audioPlayer.muted = mute.classList.contains("muted"));
  }),
  repeat.addEventListener("click", function () {
    repeat.classList.toggle("off");
  }),
  shuffle.addEventListener("click", function () {
    shuffle.classList.toggle("off");
  });
for (let e = 0; e < wave.length; e++)
  wave[e].addEventListener("click", function () {
    for (let e = 0; e < wave.length; e++)
      wave[e].classList.remove("current", "active");
    this.classList.add("current"), getPlayList();
  });
for (let e = 0; e < nav_el.length; e++)
  nav_el[e].addEventListener("click", function () {
    for (let e = 0; e < nav_el.length; e++)
      nav_el[e].classList.remove("active");
    for (let e = 0; e < screens.length; e++)
      screens[e].classList.remove("active");
    this.classList.add("active");
    const e = this.getAttribute("data-nav"),
      t = document.querySelector('*[data-screen="' + e + '"]');
    t.classList.add("active"),
      t.classList.contains("radio") &&
        !play.classList.contains("active") &&
        getPlayList();
  });
function getPlayList() {
  const e = document
    .getElementsByClassName("wave current")[0]
    .getAttribute("data-wave");
  let t = "";
  const l = { wave: e },
    a = { method: "POST", body: JSON.stringify(l) };
  fetch("get-playlist.php", a)
    .then((e) => e.json())
    .then((l) => {
      (playlist = l),
        (src.src = playlist[0].path),
        player.setAttribute("data-wave", e),
        (currentWave = e),
        player.setAttribute("data-track", "0"),
        (currentTrack = 0);
      for (let e = 0; e < playlist.length; e++)
        t +=
          0 === e
            ? `<div class="track current">${playlist[e].name}</div>`
            : `<div class="track">${playlist[e].name}</div>`;
      (playListWrapper.innerHTML = t), audioPlayer.load(), playWave();
    })
    .catch((e) => {
      console.error("Error:", e);
    });
}
function playToggler() {
  play.classList.toggle("active"),
    document
      .getElementsByClassName("wave current")[0]
      .classList.toggle("active");
}
function playWave() {
  audioPlayer.paused && audioPlayer.play(),
    play.classList.add("active"),
    document.getElementsByClassName("wave current")[0].classList.add("active");
  const e = document.getElementsByClassName("track current")[0];
  document.getElementsByClassName("music_list")[0].scrollTop = e.offsetTop - 8;
}
function playNext() {
  setActiveTrack(
    (nextTrack = shuffle.classList.contains("off")
      ? currentTrack + 2 > playlist.length
        ? 0
        : currentTrack + 1
      : getRandomInt(playlist.length))
  );
}
function setVolume(e) {
  audioPlayer.volume = e;
}
if ((playVideo(), window.location.href.indexOf("local") > -1))
    null;
else {
  let e = document.createElement("script");
  (e.src =
    "https://maps.googleapis.com/maps/api/js?key=AIzaSyAfDK6QXFdhV1zyclw9zopL-_uFv_syObI&callback=initMap"),
    e.setAttribute("async", "true"),
    e.setAttribute("defer", "true"),
    document.getElementsByTagName("body")[0].appendChild(e);
}